# Quantitative-proteomics

This repository contains Rmarkdown modules dedicated to statistical analysis of quantitative proteomic data. <br/>
They are divided up into 2 projects : 
  - Instrumental quality control
  - Quantitative data analysis 
<br/>
The 1rst project contains modules that allow the controlling of LC-MS devices stability through a serie of acquisitions by analyzing the generated signal for a reference protein (ex : CytoC). <br/>
The 2nd project is dedicated to quantitative proteomic data analysis from QC to statistical differential analysis.
<br/>
All of these modules generates html reports. Examples are provided in _Example/Reports/_.
<br/>

## 1. Launch modules with command lines

All modules can be launched by command line thanks to the scripts stored in the **"Launchers"** folder. You can find working examples of command lines in the "run.bat" file of this folder (works on Windows only). So, to execute a QC on the quantification file stored at _Example/Dataset/QC-DA/Parsed_proteins_set.txt_, you can launch the following instruction in a terminal :

_Rscript --vanilla run_proteomics_stats.R QC "../../Example/Datasets/QC-DA/Parsed_proteins_set.txt" "../../Example/Reports/QC_example.html" TRUE FALSE_

## 2. Instrumental QC project

### 2.1. Input format

The modules from the instrumental QC project take as input the "cytoc_xics" file generated by Proline's extraction module (format compliant with MSstatsQC) :

<br/>

| AcquiredTime  | Precursor | MinStartTime | MaxEndTime | Annotations | Best.RT | MaxFWHM | TotalArea | moz.assymetry | mz |
| ------------- | ------------- | ------------- | ------------- | ------------- | ------------- | ------------- | ------------- | ------------- | ------------- |
| 14/05/2019 06:43  | EDLIAYLK  | 27.155064 | 28.234272 | RAW = QEMYC190513_16; mz = 482.7719957778697; delta PPM = 2 | 27.326147 | 0.009494722 | 5.92E+07 | 0.9891489 |482.77 |
| ...  | ...  | ...  | ...  | ...  | ...  | ...  | ...  | ...  | ...  |

<br/>

You can see examples in _Example/Datasets/CytoC_.

### 2.2. Modules description

The instrumental QC project includes 2 modules (located at _Modules/Instrumental QC_):
- Descriptive_CytoC.rmd : this module generates a report which shows the evolution of metrics (RT, intensity, PPM) accross the acquired times.
- Comparative_CytoC.rmd : this module generates a report which evaluates the validity of metrics in a test serie based on observed metrics in a reference serie.


## 3. Quantitative data analysis project

### 3.1. Input format

The QC & DA modules work with a standardized input format that can be obtain from any quantification file thanks to the parsers stored in the **"Parsers"** folder. The ROC module take as input a folder containing tables generated by the DA module.

### 3.2. Modules description

#### 3.2.1. QC module

The QC module generates a report providing a global visualization of data quality and reproducibility. The user can set two parameters in the command line:
- "normalization option": should intensities be normalized or not (T/F) ?
- "delete empty lines" : should proteins with no observed intensities be removed from the dataset (T/F) ?

#### 3.2.2. DA module

The DA module allows to process the data (filtering, normalization, missing values imputation) and to realize a statistical differential analysis to detect variants between biological conditions:

![Alt text](Images/Workflow.PNG?raw=true "Title")

<br>

This worklow can be configured thanks to the following parameters :

| Parameter | Function | Values |
| --------- | --------- | --------- |
| Normalisation | Should intensities be normalized or not ? | T / F |
| Filter.threshold.ms | Minimum number of file identified by MS/MS to keep the protein for the analysis | ℕ |
| Filter.threshold.obs | Minimum percentage of observed intensities in one condition at least to keep the protein for the analysis | {0,100} |
| Imputation.MNAR.model | Which model should be used to impute MNAR ? | percentile / gaussian |
| Imputation.MNAR.percentile | Which percentile should be used for the "percentile" imputation model ? | {0,1} |
| Imputation.MCAR.model | Which model should be used to impute MCAR ? | none / MNAR / knn |
| Imputation.MCAR.threshold.obs | Minimum number of observed intensities in a condition to classify the missing values as MCAR | {0, number of replicates} |
| Imputation.MCAR.threshold.MSMS | Minimum number of file identified by MS/MS in a condition to classify the missing values as MCAR | {0, number of replicates} |
| Imputation.knn.min.occurrences |  Minimum number of observed intensities in a condition to use the protein as a k-nearest-neighnour for KNN imputation model | {0, number of replicates} |
| Test.type | Which statistical test should be used ? | t.test / limma / wilcoxon |
| Test.log | Should intensities be transformed by log10 before executing the statistical test ? | T / F |
| Test.alternative | Choose if the statistical test should be unilateral or bilateral | two.sided / less / greater |
| Test.paired | Choose if the statistical test should be paired or not | T / F |
| Test.var.equal | If t.test is selected, precise if variance are equal (so a Student t.test will be used) or not (so a Welch t.test will be used)  | T / F |
| Test.adjust.procedure | Choose the multiple test correction procedure | none / BH / ABH |
| Test.adjust.FDR | Choose the FDR for multiple test correction | {0,1} |
| Ratio | Choose the ratio that should be computed between conditions | fc / zscore |
| Volcano.threshold.pvalue | Significativity threshold for pvalue | {0,1} |
| Volcano.threshold.ratio | Significativity threshold for ratio | ℝ |
| Comparisons | List of paired conditions to compare | Exemple : 50fmol-25fmol;50fmol-10fmol |

Here you can see an example of parameters file with default values : <br/>
<br/>
The experimental design also have to be provided as an input. Here you can see an example of experimental design file : .<br/>
<br/>
The module gives as outputs a TSV table summarizing input data, intensities after each step of processing and final results of statistical results. A report containg QC figures for each processing step and figures showing the results of differential analysis is also provided.
<br/>
